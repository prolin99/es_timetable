<link rel="stylesheet" type="text/css" media="all" href="<{$xoops_url}>/modules/tadtools/bootstrap/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" media="all" href="<{$xoops_url}>/modules/tadtools/bootstrap/css/bootstrap-responsive.css" />
<link rel="stylesheet" type="text/css" media="all" href="<{$xoops_url}>/modules/tadtools/css/xoops_adm.css" />
<link rel="stylesheet" href="<{$xoops_url}>/modules/tadtools/jquery/themes/base/jquery-ui.css">
<script src="<{$xoops_url}>/modules/tadtools/jquery/ui/jquery-ui.js"></script>
<style>
.groupbox {
 
    border: 1px dotted gray;
    background-color: #EEE;

}
.show_hit {

    color: #777;

}
.teacher_set {
 
    border: 1px dotted gray;

.text-grey {
  color: red;
opacity:0.5;
  filter:alpha(opacity=50); /* For IE8 and earlier */  
} 
}
</style>
 
 <h3><{$data.n_y}> 學年度<{$data.n_s}> 學期</h3>
  
      <div class="row-fluid" > <!-- box1 -->

     

      <div class="span10" id="table_div">
      	<div class="row-fluid" >
      	<div class='span3'>
          <form action="set_room.php"  method="post">
      	教師：<{html_options name=teacher_id id=teacher_id  options=$data.teacher_list  selected=$data.teacher_sel  onchange="submit();"  class="span8" }> 
        </form>
      	</div>

      <div class='span3'>
        經費：<{html_options name=over_id id=over_id  options=$DEF_SET.es_tt_over_list    class="span8" }> 
      </div> 

      <div class='span6'>
        <{if ($data.error)}>
          <div class="alert alert-error">
          重複:<br />
          <{$data.error}>
          </div>
        <{/if}>        
      </div>
      	</div>

      <table class="table table-bordered">
      <tr>
      <td class="span1">節</td>
      <{section name=di  start=1  loop=$DEF_SET.days_sm  step=1  }>
      <td ><{$DEF_SET.week[$smarty.section.di.index]}></td>
      <{ /section }>
      </tr>      
      <{section name=si  start=1  loop=$DEF_SET.sects_sm    step=1  }>
      <tr>
      <td class="span1"><{$DEF_SET.sects_cht_list[$smarty.section.si.index]}></td>
      <{section name=di  start=1  loop=$DEF_SET.days_sm    step=1  }>
      <td class="span2">
      	<div class="groupbox span12" data_ref="sect_<{$smarty.section.di.index}>_<{$smarty.section.si.index}>" id="sect_<{$smarty.section.di.index}>_<{$smarty.section.si.index}>" style="background:#EEE;">
          <{assign var="cid" value=$tab[$smarty.section.di.index][$smarty.section.si.index].class_id}>
          <{$data.class_list_c[$cid]}><br />
          <{$tab[$smarty.section.di.index][$smarty.section.si.index].subject_name}><br />
           <{if ($tab[$smarty.section.di.index][$smarty.section.si.index].class_id) }>
           <input id="<{$tab[$smarty.section.di.index][$smarty.section.si.index].course_id}>" value="<{$tab[$smarty.section.di.index][$smarty.section.si.index].room}>" class="span8 text_edit" title="移開後自動存入" type="text">
           <{if  ($tab[$smarty.section.di.index][$smarty.section.si.index].c_kind) }>
              <span class="plus" id="plus_<{$tab[$smarty.section.di.index][$smarty.section.si.index].course_id}>"  id_num="<{$tab[$smarty.section.di.index][$smarty.section.si.index].course_id}>" data='<{ $tab[$smarty.section.di.index][$smarty.section.si.index].c_kind}>'><i   class='icon-plus-sign' title='超鐘點'> </i><{ $tab[$smarty.section.di.index][$smarty.section.si.index].c_kind}></span>
           <{else}>
            
              <span class="plus"  id="plus_<{$tab[$smarty.section.di.index][$smarty.section.si.index].course_id}>"  id_num="<{$tab[$smarty.section.di.index][$smarty.section.si.index].course_id}>"  data='0'><i   class="icon-minus" title='非超鐘點'> </i></span>
           <{/if}>
           <{/if}>
          <br /></div>
		 
      </td>
      <{ /section }>
      </tr>
      <{ /section }>
      </table>

      
      </div>      <!-- table_div end-->

      
      </div><!-- box1 end-->
      
      <div class="alert alert-info">
        <p>
            <span class="label label-info">說明</span><br />
            科任教室才需設定教室位置，可做出該科任教室的課表。<br />
            點選圖示：<i   class="icon-minus" title='非超鐘點'> </i>，可以指定為超鐘點<i   class='icon-plus-sign' title='超鐘點'> </i>。方便列印簽到表。<br />
 
        </p>  
      </div> 
      
<SCRIPT type="text/javascript">
 
//修改科目
$(function() {
  $(".text_edit").change(function(){
    var v_id = $( this ).attr('id') ;
    var edit_text = $( this ).val();
    //alert(v_id) ;
    save_teacher_room( 'edit' ,v_id ,  edit_text ) ;
  });
});  
  
//超時鐘點
  $(document).on("click", ".plus", function(){
      var div_id = $(this).attr("id")  ;
      var id_num = $(this).attr("id_num")  ;
      var in_plus = $(this).attr("data")  ;
      var  kind = $('#over_id').val() ;
      //alert(kind) ;

      
      if (in_plus=='0') {
         $('#' + div_id).html( "<i   class='icon-plus-sign' title='超鐘點'></i>" + kind) ;
         $('#' + div_id).attr("data", kind) ;       
      }else {
        $('#' + div_id).html( "<i   class='icon-minus' title='非超鐘點'></i>") ;
        $('#' + div_id).attr("data","0") ;   
        kind=0 ;     

      }
      save_teacher_room( 'plus' , id_num ,  kind ) ;
   });  

 //寫入 
 function save_teacher_room(do_mode ,tid , sdata )  {
    $.ajax({
    url: 'ajax_set_teacher_room.php',
    type: 'GET',
    data: {do: do_mode , id:tid  , setdata :sdata    },
  })
  .done(function(data) {
    console.log("success");
    //alert(data) ;
  })
  .fail(function() {
    console.log("error");
    
  })
  .always(function() {
    console.log("complete");
  });
  } 
</script> 